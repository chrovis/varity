<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>varity.ref-gene documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="highlight/solarized-light.css" /><script type="text/javascript" src="highlight/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a> with <a href="https://github.com/xsc/codox-theme-rdash">RDash UI</a> theme</h2><h1><a href="index.html"><span class="project-title"><span class="project-name">varity</span> <span class="project-version">0.9.2</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>varity</span></div></div></li><li class="depth-2 branch"><a href="varity.chain.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>chain</span></div></a></li><li class="depth-2 branch"><a href="varity.check.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>check</span></div></a></li><li class="depth-2 branch"><a href="varity.codon.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>codon</span></div></a></li><li class="depth-2 branch"><a href="varity.fusion.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fusion</span></div></a></li><li class="depth-2 branch"><a href="varity.hgvs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>hgvs</span></div></a></li><li class="depth-2 branch"><a href="varity.hgvs-to-vcf.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>hgvs-to-vcf</span></div></a></li><li class="depth-2 branch"><a href="varity.hgvs-vcf-check.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>hgvs-vcf-check</span></div></a></li><li class="depth-2 branch"><a href="varity.lift.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>lift</span></div></a></li><li class="depth-2 branch current"><a href="varity.ref-gene.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ref-gene</span></div></a></li><li class="depth-2 branch"><a href="varity.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-2 branch"><a href="varity.vcf-lift.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>vcf-lift</span></div></a></li><li class="depth-2"><a href="varity.vcf-to-hgvs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>vcf-to-hgvs</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="varity.ref-gene.html#var-cds-.3Egenomic-pos"><div class="inner"><span>cds-&gt;genomic-pos</span></div></a></li><li class="depth-1"><a href="varity.ref-gene.html#var-cds-coord"><div class="inner"><span>cds-coord</span></div></a></li><li class="depth-1"><a href="varity.ref-gene.html#var-cds-coord-.3Egenomic-pos"><div class="inner"><span>cds-coord-&gt;genomic-pos</span></div></a></li><li class="depth-1"><a href="varity.ref-gene.html#var-cds-pos"><div class="inner"><span>cds-pos</span></div></a></li><li class="depth-1"><a href="varity.ref-gene.html#var-cds-region"><div class="inner"><span>cds-region</span></div></a></li><li class="depth-1"><a href="varity.ref-gene.html#var-cds-seq"><div class="inner"><span>cds-seq</span></div></a></li><li class="depth-1"><a href="varity.ref-gene.html#var-exon-ranges-.3Eintron-ranges"><div class="inner"><span>exon-ranges-&gt;intron-ranges</span></div></a></li><li class="depth-1"><a href="varity.ref-gene.html#var-exon-seq"><div class="inner"><span>exon-seq</span></div></a></li><li class="depth-1"><a href="varity.ref-gene.html#var-find-ens-g-id"><div class="inner"><span>find-ens-g-id</span></div></a></li><li class="depth-1"><a href="varity.ref-gene.html#var-find-ens-t-id"><div class="inner"><span>find-ens-t-id</span></div></a></li><li class="depth-1"><a href="varity.ref-gene.html#var-in-any-exon.3F"><div class="inner"><span>in-any-exon?</span></div></a></li><li class="depth-1"><a href="varity.ref-gene.html#var-in-cds.3F"><div class="inner"><span>in-cds?</span></div></a></li><li class="depth-1"><a href="varity.ref-gene.html#var-in-exon.3F"><div class="inner"><span>in-exon?</span></div></a></li><li class="depth-1"><a href="varity.ref-gene.html#var-index"><div class="inner"><span>index</span></div></a></li><li class="depth-1"><a href="varity.ref-gene.html#var-load-gencode"><div class="inner"><span>load-gencode</span></div></a></li><li class="depth-1"><a href="varity.ref-gene.html#var-load-gff3"><div class="inner"><span>load-gff3</span></div></a></li><li class="depth-1"><a href="varity.ref-gene.html#var-load-gtf"><div class="inner"><span>load-gtf</span></div></a></li><li class="depth-1"><a href="varity.ref-gene.html#var-load-ref-genes"><div class="inner"><span>load-ref-genes</span></div></a></li><li class="depth-1"><a href="varity.ref-gene.html#var-load-ref-seqs"><div class="inner"><span>load-ref-seqs</span></div></a></li><li class="depth-1"><a href="varity.ref-gene.html#var-max-tx-margin"><div class="inner"><span>max-tx-margin</span></div></a></li><li class="depth-1"><a href="varity.ref-gene.html#var-read-coding-sequence"><div class="inner"><span>read-coding-sequence</span></div></a></li><li class="depth-1"><a href="varity.ref-gene.html#var-read-exon-sequence"><div class="inner"><span>read-exon-sequence</span></div></a></li><li class="depth-1"><a href="varity.ref-gene.html#var-read-transcript-sequence"><div class="inner"><span>read-transcript-sequence</span></div></a></li><li class="depth-1"><a href="varity.ref-gene.html#var-ref-genes"><div class="inner"><span>ref-genes</span></div></a></li><li class="depth-1"><a href="varity.ref-gene.html#var-rna-accession.3F"><div class="inner"><span>rna-accession?</span></div></a></li><li class="depth-1"><a href="varity.ref-gene.html#var-seek-gene-region"><div class="inner"><span>seek-gene-region</span></div></a></li><li class="depth-1"><a href="varity.ref-gene.html#var-tx-region"><div class="inner"><span>tx-region</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">varity.ref-gene</h1><div class="doc"><pre class="plaintext">Handles refGene.txt(.gz) and ncbiRefSeq.txt(.gz) content.
</pre></div><div class="public anchor" id="var-cds-.3Egenomic-pos"><h3>cds-&gt;genomic-pos</h3><div class="usage"><code>(cds-&gt;genomic-pos cds-pos rg)</code><code>(cds-&gt;genomic-pos cds-pos region {:keys [strand cds-start cds-end exon-ranges]})</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L475">view source</a></div></div><div class="public anchor" id="var-cds-coord"><h3>cds-coord</h3><div class="usage"><code>(cds-coord pos rg)</code></div><div class="doc"><pre class="plaintext">Converts the genomic position into the coding DNA coordinate. The return
value is clj-hgvs.coordinate/CodingDNACoordinate record.</pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L455">view source</a></div></div><div class="public anchor" id="var-cds-coord-.3Egenomic-pos"><h3>cds-coord-&gt;genomic-pos</h3><div class="usage"><code>(cds-coord-&gt;genomic-pos coord {:keys [strand], :as rg})</code></div><div class="doc"><pre class="plaintext">Converts the coding DNA coordinate into the genomic position. coord must be
clj-hgvs.coordinate/CodingDNACoordinate record.</pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L504">view source</a></div></div><div class="public anchor" id="var-cds-pos"><h3>cds-pos</h3><div class="usage"><code>(cds-pos pos {:keys [strand cds-start cds-end exon-ranges]})</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L441">view source</a></div></div><div class="public anchor" id="var-cds-region"><h3>cds-region</h3><div class="usage"><code>(cds-region {:keys [chr cds-start cds-end strand]})</code></div><div class="doc"><pre class="plaintext">Returns a genomic region of a coding sequence of the given gene. Returns nil
if the gene is a non-coding RNA.</pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L312">view source</a></div></div><div class="public anchor" id="var-cds-seq"><h3>cds-seq</h3><div class="usage"><code>(cds-seq {:keys [cds-start cds-end], :as ref-gene-record})</code></div><div class="doc"><pre class="plaintext">Returns a lazy sequence of exons included in a coding region of a
`ref-gene-record`. Note that exons outside of the CDS are removed and
partially overlapping ones are cropped in the result. Returns nil if the record
is a non-coding RNA.</pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L336">view source</a></div></div><div class="public anchor" id="var-exon-ranges-.3Eintron-ranges"><h3>exon-ranges-&gt;intron-ranges</h3><div class="usage"><code>(exon-ranges-&gt;intron-ranges exon-ranges)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L375">view source</a></div></div><div class="public anchor" id="var-exon-seq"><h3>exon-seq</h3><div class="usage"><code>(exon-seq {:keys [chr strand exon-ranges]})</code></div><div class="doc"><pre class="plaintext">Returns a lazy sequence of regions corresponding to each exon in a gene. The
exons are ordered by their index, thus they're reversed in genomic coordinate
if the refGene record is on the reverse strand.</pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L319">view source</a></div></div><div class="public anchor" id="var-find-ens-g-id"><h3>find-ens-g-id</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L120">view source</a></div></div><div class="public anchor" id="var-find-ens-t-id"><h3>find-ens-t-id</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L119">view source</a></div></div><div class="public anchor" id="var-in-any-exon.3F"><h3>in-any-exon?</h3><div class="usage"><code>(in-any-exon? chr pos rgidx)</code></div><div class="doc"><pre class="plaintext">Returns true if chr:pos is located in any ref-gene exon, else false.
</pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L300">view source</a></div></div><div class="public anchor" id="var-in-cds.3F"><h3>in-cds?</h3><div class="usage"><code>(in-cds? pos {:keys [cds-start cds-end]})</code></div><div class="doc"><pre class="plaintext">Returns true if pos is in the coding region, false otherwise.
</pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L14">view source</a></div></div><div class="public anchor" id="var-in-exon.3F"><h3>in-exon?</h3><div class="usage"><code>(in-exon? pos {:keys [exon-ranges]})</code></div><div class="doc"><pre class="plaintext">Returns true if pos is in the exon region, false otherwise.
</pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L19">view source</a></div></div><div class="public anchor" id="var-index"><h3>index</h3><div class="usage"><code>(index rgs)</code></div><div class="doc"><pre class="plaintext">Creates refGene index for search.
</pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L276">view source</a></div></div><div class="public anchor" id="var-load-gencode"><h3>load-gencode</h3><div class="usage"><code>(load-gencode f parse-line &amp; {:keys [chunk-size], :or {chunk-size 10000}})</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L209">view source</a></div></div><div class="public anchor" id="var-load-gff3"><h3>load-gff3</h3><div class="usage"><code>(load-gff3 f &amp; {:keys [chunk-size], :or {chunk-size 10000}, :as opts})</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L226">view source</a></div></div><div class="public anchor" id="var-load-gtf"><h3>load-gtf</h3><div class="usage"><code>(load-gtf f &amp; {:keys [chunk-size], :or {chunk-size 10000}, :as opts})</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L219">view source</a></div></div><div class="public anchor" id="var-load-ref-genes"><h3>load-ref-genes</h3><h4 class="deprecated">deprecated in 0.8.0</h4><div class="usage"><code>(load-ref-genes f &amp; {:keys [filter-fns], :or {filter-fns [identity]}})</code></div><div class="doc"><pre class="plaintext">DEPRECATED: Loads f (e.g. refGene.txt(.gz)), returning the all contents as a sequence.
</pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L75">view source</a></div></div><div class="public anchor" id="var-load-ref-seqs"><h3>load-ref-seqs</h3><div class="usage"><code>(load-ref-seqs f &amp; {:keys [filter-fns], :or {filter-fns [identity]}})</code></div><div class="doc"><pre class="plaintext">Loads f (e.g. ncbiRefSeq.txt(.gz)), returning the all contents as a sequence.
</pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L81">view source</a></div></div><div class="public anchor" id="var-max-tx-margin"><h3>max-tx-margin</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L243">view source</a></div></div><div class="public anchor" id="var-read-coding-sequence"><h3>read-coding-sequence</h3><div class="usage"><code>(read-coding-sequence seq-rdr ref-gene-record)</code></div><div class="doc"><pre class="plaintext">Reads a coding sequence of a ref-gene record `ref-gene-record` from
`seq-rdr`. Returns nil if the gene is a non-coding RNA.</pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L366">view source</a></div></div><div class="public anchor" id="var-read-exon-sequence"><h3>read-exon-sequence</h3><div class="usage"><code>(read-exon-sequence seq-rdr {:keys [strand], :as exon})</code></div><div class="doc"><pre class="plaintext">Reads a base sequence of an `exon` from `seq-rdr`.
</pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L351">view source</a></div></div><div class="public anchor" id="var-read-transcript-sequence"><h3>read-transcript-sequence</h3><div class="usage"><code>(read-transcript-sequence seq-rdr ref-gene-record)</code></div><div class="doc"><pre class="plaintext">Reads a DNA base sequence of a `ref-gene-record` from `seq-rdr`. The sequence
contains 5'-UTR, CDS and 3'-UTR.</pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L357">view source</a></div></div><div class="public anchor" id="var-ref-genes"><h3>ref-genes</h3><div class="usage"><code>(ref-genes s rgidx)</code><code>(ref-genes chr pos rgidx)</code><code>(ref-genes chr pos rgidx tx-margin)</code></div><div class="doc"><pre class="plaintext">Searches refGene entries with ref-seq, gene or (chr, pos) using index,
returning results as sequence. See also varity.ref-gene/index.</pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L283">view source</a></div></div><div class="public anchor" id="var-rna-accession.3F"><h3>rna-accession?</h3><div class="usage"><code>(rna-accession? s)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L61">view source</a></div></div><div class="public anchor" id="var-seek-gene-region"><h3>seek-gene-region</h3><div class="usage"><code>(seek-gene-region chr pos rgidx)</code><code>(seek-gene-region chr pos rgidx name)</code></div><div class="doc"><pre class="plaintext">Seeks chr:pos through exon entries in refGene and returns those indices
</pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L381">view source</a></div></div><div class="public anchor" id="var-tx-region"><h3>tx-region</h3><div class="usage"><code>(tx-region {:keys [chr tx-start tx-end strand]})</code></div><div class="doc"><pre class="plaintext">Returns a genomic region of the given gene.
</pre></div><div class="src-link"><a href="https://github.com/chrovis/varity/blob/0.9.2/src/varity/ref_gene.clj#L307">view source</a></div></div></div></body></html>